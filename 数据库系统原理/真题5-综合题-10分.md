# 综合题（1 道大题，10 分）

- 考察：ER 图、关系模式、范式、SQL

1. 【2023.04】某电影管理中心需要管理如下信息：  
   电影：电影编号，电影名，电影类型  
   演员：身份证号码，姓名，性别，年龄  
   出演：电影编号，身份证号码，拍摄年份  
   其中：每部电影可以有多名演员参与演出；每位演员可在多部电影中出演；每部电影都有具体的拍摄年份。  
   试按要求完成下列问题：

   1）画出反映上述实体关系的 E-R 图。（不必画实体的属性）（3 分）

   2）转换成关系模式并指出每个关系模式的主码和外码，在主码下画直线“\_\_\_\_”，在外码下画波浪线“﹏﹏”。（3 分）

   3）用 SQL 语句建立“演员”表。（4 分）

   - 参考答案

     - 1）
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3345/images/3106.png)
     - 2）
       - 电影与演员是`多对多关系`。一个多对多联系转换为一个关系模式。
       - 电影(<u>电影编号</u>，电影名，电影类型);
       - 演员(<u>身份证号码</u>，姓名，性别，年龄);
       - 出演(`电影编号，身份证号码`，拍摄年份);
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3345/images/3175.png)
     - 3）

       ```sql
          create table actor (
             actor_id varchar(20),
             actor_name varchar(20),
             sex varchar(20),
             age int(10),
             primary key actor_id
          );

          //用SQL语句建立“演员”表：
          CREATE TABLE演员
          (
             身份证号码 CHAR(18),
             姓名 CHAR(20),
             性别 CHAR(2),
             年龄 INT,
             PRIMARY KEY(身份证号码)
          );
       ```

2. 【2022.10】某大学图书管理信息系统需要管理如下信息：
   图书：图书号、书名、作者、定价  
   学生：学号、姓名、专业  
   出版社：出版社名称、地址、电话、邮编  
   其中：一个出版社可以出版多种图书，但每本图书只能在一个出版社出版；每位学生可以借阅多本图书，每本图书可以供多位学生借阅；学生借书要记录借书日期和还书日期。  
   试完成下列要求：

   1）画出反映上述实体关系的 E-R 图。（不必画实体的属性）（3 分）

   2）转换成关系模式并指出每个关系模式的主码和外码，在主码下画直线“\_\_\_”，在外码下画波浪线“﹏﹏”。（3 分）

   3）用 SQL 语句建立“学生”表。（4 分）

   - 参考答案

     - 1）
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3002/images/3430.png)
     - 2）
       - 图书(<u>图书号</u>、书名、作者、定价、`出版社名称`)
       - 学生(<u>学号</u>、姓名、专业)
       - 出版社(<u>出版社名称<u>、地址、电话、邮编)
       - `借阅(**图书号，学号**，借书日期, 还书日期)`
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3002/images/3499.png)
     - 3）

       ```sql
          create table 学生(
             学号 int,
             姓名 char(20),
             专业 char(20),
             primary key(学号)
          );

          CREATE TABLE 学生
          (学号 CHAR(9) PRIMARY KEY,
          姓名 CHAR(8),
          专业 CHAR(20));
       ```

3. 【2022.04】某电视剧管理中心需要管理如下信息：  
   电视剧编号，电视剧名称，拍摄年份，总导演身份证号码，姓名，性别，年龄。  
   其中：每部电视剧只能有一位总导演；每位总导演可指导多部电视剧拍摄；每部电视剧都有具体的拍摄年份。

   1）画出反映上述实体关系的 E-R 图。（不必画实体的属性）（3 分）

   2）转换成关系模式并指出每个关系模式的主码和外码，在主码下画直线“\_\_\_”，在外码下画波浪线“﹏﹏”。（3 分）

   3）用 SQL 语句建立“总导演”表。（4 分）

   - 参考答案

     - 1）
       - 实体：电视剧（编号，名称，拍摄年份）；总导演（身份证号码，姓名，性别，年龄）
       - 实体间联系：导演 —— 拍摄 —— 电视剧
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/1828/images/3187.png)
     - 2）
       - 1 对多
       - ![image](https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/1828/images/3255.png)
     - 3）

       ```sql
          create table 总导演(
             身份证号码 char(18)，姓名 char(20)，性别 char(2)，年龄 int, primary key(身份证号码)
          );

          CREATE TABLE 总导演
          ( 总导演身份证号码 CHAR(18) PRIMARY KEY,
          姓名 CHAR(20),
          性别 CHAR(2),
          年龄 INT);
       ```

4. 【2021.10】某医院病房计算机管理中心需要如下信息：  
   科室：科室名，地址，电话  
   医生：工作证号，姓名，职称，年龄，科室名  
   病人：病历号，姓名，性别，主治医生工作证号  
   其中：一个科室有多名医生，一个医生只能属于一个科室，但可负责多个病人的诊治，一个病人的主治医生只有一个。

   1）试画出反映上述实体关系的 E-R 图（不必画实体的属性）（3 分）  
   2）转换成关系模式并指出每个关系模式的主码和外码，在主码下画直线\_\_\_\_，在外码下画波浪线﹏﹏。（3 分）  
   3）用 SQL 语句建立“科室”表。（4 分）

5. `【2021.04】`设有关系模式 R（学号，姓名，系号，系名，课程号，课程名，考试类型，成绩）存储学生选修课程等信息。
   如果规定：每个学生只能在一个系学习；  
    考试类型有一考、二考、补考，每个学生每门课程每个考试类型只能有一个成绩。

   1）根据上述条件，写出模式 R 的关键字。（2 分）  
    2）R 最高属于第几范式，为什么？（2 分）  
    3）举例说明 R 在何种情况下会发生删除异常。（2 分）  
    4）将 R 规范到 3NF。（4 分）

   - 参考答案
     1. 属于第一范式，因为存在非主属性对码的部分函数依赖。
     2. 删除学生选课信息或成绩信息时有可能把学生的基本信息也删除了。
     3. R1(学号，姓名，系号)；R2(系号，系名)；R3(课程号，课程名)；R4(学号，课程号，考试类型，成绩)

6. 【2020.10】设有如下实体：  
   读者：读者号，姓名，出生日期，单位号  
   图书：图书号，书名，出版社，定价  
   单位：单位号，单位名  
   其中，每个单位有若干读者，每名读者只属于一个单位；每名读者可借阅多本图书，每本图书可被多名读者借阅，读者借阅图书要记录借书日期。

   1）试画出反映上述实体关系的 ER 图（不必画实体的属性）。（3 分）
   2）转换成关系模式并指出每个关系模式的主码和外码，在主码下画直线**\_**，在外码下画波浪线﹏﹏。（4 分）  
   3）用 SQL 语言建立“单位”表。（3 分）

7. 【2020.08】设有关系模式 R（商品号，商品名，类号，类名，商店号，商店名，销售日期，售价）存储商店销售商品等信息。如果规定：每个商品只属于一个类别：每个商店可以销售多种商品，每种商品也可以在多个商店销售，同种商品可以有不同的售价，但每个商店的每种商品每天只能有一个售价。

   1）根据上述条件，写出模式 R 的关键字。（2 分）

   2）R 最高属于第几范式，为什么？（3 分）

   3）举例说明 R 在何种情况下会发生删除异常。（2 分）

   4）将 R 规范到 3NF。（3 分）

8. 【2019.10】设有如下实体：  
   读者：读者号，姓名，出生日期  
   图书：图书号，图书名，作者，出版社，定价  
   类别：类号，类名  
   其中，每一类别有多本图书，每本图书只属于一个类别；每本图书可以被多名读者借阅，每个读者可以借阅多本图书，读者借阅图书要记录结束日期、还书日期。

   1）试画出反映上述实体关系的 E-R 图（不必画实体的属性）。（3 分）  
   2）转换成关系模式，并指出每个关系模式的主码和外码（如果有外码指出来），在主码下画直线＿，在外码下画波浪线﹏。（3 分）  
   1）用 SQL 语言建立“类别”表。（4 分）

9. 【2019.04】设有如下实体：
   学生：学号，姓名，性别  
   课程：课程号，课程名，学分  
   班级：班号，班名  
   其中，每个班有若干学生，每个学生只可以在一个班级学习；每个学生可选修多门课程，每门课程可被多个学生选修，学生选修课程要记录成绩。

   1）试画出反映上述实体关系的 E-R 图（不必画实体的属性）。（3 分）  
   2）转换成关系模式，并指出每个关系模式的主码和外码（如果有外码指出来），在主码下画直线＿，在外码下画波浪线﹏。（3 分）  
   3）用 SQL 语言建立“课程”表。（4 分）

10. 【2018.10】设有关系模式 R(读者号，姓名，单位号，单位名，图书号，书名，借阅日期，还书目期)存储读者借阅图书等信息。如果规定：每个读者只属于一个单位；每个读者可以借阅多本图书，每本图书也可以被多名读者借阅，每个读者也可以对某本图书多次借阅，但每个读者每本图书每天最多借一次。

    1）根据上述条件，写出模式 R 的关键字。（2 分）

    2）R 最高属于第几范式，为什么？（2 分）

    3）举例说明 R 在何种情况下会发生删除异常。（2 分）

    4）将 R 规范到 3NF。（4 分）
