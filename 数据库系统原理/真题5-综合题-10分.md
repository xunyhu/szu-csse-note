# 综合题（1 道大题，10 分）

- 考察：ER 图、关系模式、范式、SQL

1. 【2022.04】某电视剧管理中心需要管理如下信息：  
   电视剧编号，电视剧名称，拍摄年份，总导演身份证号码，姓名，性别，年龄。  
   其中：每部电视剧只能有一位总导演；每位总导演可指导多部电视剧拍摄；每部电视剧都有具体的拍摄年份。

   1）用 SQL 语句建立“总导演”表。（4 分）

2. 【2021.10】某医院病房计算机管理中心需要如下信息：  
   科室：科室名，地址，电话  
   医生：工作证号，姓名，职称，年龄，科室名  
   病人：病历号，姓名，性别，主治医生工作证号  
   其中：一个科室有多名医生，一个医生只能属于一个科室，但可负责多个病人的诊治，一个病人的主治医生只有一个。

   1）用 SQL 语句建立“科室”表。（4 分）

3. 【2020.10】设有如下实体：  
   读者：读者号，姓名，出生日期，单位号  
   图书：图书号，书名，出版社，定价  
   单位：单位号，单位名  
   其中，每个单位有若干读者，每名读者只属于一个单位；每名读者可借阅多本图书，每本图书可被多名读者借阅，读者借阅图书要记录借书日期。

   1）用 SQL 语言建立“单位”表。（3 分）

4. 【2020.08】设有关系模式 R（商品号，商品名，类号，类名，商店号，商店名，销售日期，售价）存储商店销售商品等信息。如果规定：每个商品只属于一个类别：每个商店可以销售多种商品，每种商品也可以在多个商店销售，同种商品可以有不同的售价，但每个商店的每种商品每天只能有一个售价。

   1）根据上述条件，写出模式 R 的关键字。（2 分）

   2）R 最高属于第几范式，为什么？（3 分）

   3）举例说明 R 在何种情况下会发生删除异常。（2 分）

   4）将 R 规范到 3NF。（3 分）

5. 【2019.10】设有如下实体：  
   读者：读者号，姓名，出生日期  
   图书：图书号，图书名，作者，出版社，定价  
   类别：类号，类名  
   其中，每一类别有多本图书，每本图书只属于一个类别；每本图书可以被多名读者借阅，每个读者可以借阅多本图书，读者借阅图书要记录结束日期、还书日期。

   1）用 SQL 语言建立“类别”表。（4 分）

6. 【2018.10】设有关系模式 R(读者号，姓名，单位号，单位名，图书号，书名，借阅日期，还书目期)存储读者借阅图书等信息。如果规定：每个读者只属于一个单位；每个读者可以借阅多本图书，每本图书也可以被多名读者借阅，每个读者也可以对某本图书多次借阅，但每个读者每本图书每天最多借一次。

   1）根据上述条件，写出模式 R 的关键字。（2 分）

   2）R 最高属于第几范式，为什么？（2 分）

   3）举例说明 R 在何种情况下会发生删除异常。（2 分）

   4）将 R 规范到 3NF。（4 分）
