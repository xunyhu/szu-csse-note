## 第 2 章 进程管理

#### 【一种题型，进程同步程序填空，记录型信号量】

1. （10 分）某医院眼科门诊有 n 个医生，有 m 个挂号窗口，可以同时容纳 m 个病人同时挂号每个病人需先挂号，然后找空闲的医生就医，如没有空闲的医生则等待。以下算法用记录型信号量机制实现了病人的就医过程，其中信号量的定义已给出。请`补充题目中的信号量初始值及信号量操作`。

```
var window,
doctor:semaphore ;
window.value = (1____);   // m
doctor.value=（2_____）;    // n

cobegin
void process Patient(i) {
    (3_____);   // wait(window)
    挂号;
    (4_____);   // signal(window)
    (5_____);   // wait(doctor)
    看病;
    (6_____);   // signal(doctor)
}
coend

//题解
s.value 表示资源的数量
每次的wait(s)操作等于s.value = s.value - 1;
每次的signal(s)操作等于s.value = s.value + 1;
```

2. 以下表格是两个同步进程的模拟执行，`生产者将物品放入共享缓冲区供消费者使用`，缓冲区可放 2 件物品，使用 2 个信号量，并置初值为 S1=2，S2=0。现已知操作情况，请填写信号量值并说明操作结果（正常、阻塞或唤醒。如阻塞或者唤醒，需说明阻塞或者被唤醒的是 P1 还是 P2）。（10 分）
<div class="block"><!----> <span>（提示：缓冲区满，不许放物品；缓冲区空，不许取物品。）</span></div>
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3341/images/3643.png">

```md
思路：调用 wait()值 - 1；调用 signal()值 + 1；
```

<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3341/images/4091.png"></p>

## 第 3 章 进程调度与死锁

### 【考点：1）三种调度算法（FCFS/SPF/优先权）； 2）银行家算法】

#### 银行家算法

1. 某操作系统中有四个进程 P1、P2、P3、P4，三类资源 A、B 和 C，其中 A 资源有 9 个，B 类资源有 3 个，C 类资源有 6 个。在 T 时刻，系统的资源分配状态如表所示。
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3511/images/002.png"></p>

（3 分）T0 时刻系统安全吗？为什么？

<p>安全，因为T0时刻存在一个安全序列{P2,P1,P3,P4}。(P1、P3和P4的位置可以互换。)</p>

（3 分）P2 发出请求 request=（1，0，1），系统能否将资源配给 P2？为什么？

<p>可以分配。此时存在一个安全序列{P2,P1,P3,P4}</p>

（4 分）在上题的基础上，P1 发出请求 request=（0，0，1），系统能否资源配给 P1？为什么？

<p>不能分配。因为在P2申请资源后，再分配2（0,0,1）给P1,剩余可用资源Available=（0,1,0），此时不再存在安全序列。</p>

#### 调度算法（FCFS/SPF）

1. 某系统中有四个进程，它们进入系统的时间和需要服务的时间如表所示（表中数值均为十进制）：
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3341/images/4151.png"> </p>

```md
等待时间 = 开始运行时间 - 到达时间；
周转时间 = 结束时间 - 到达时间；
带权周转时间 = 周转时间 / 服务时间；
```

- 采用先来先服务调度算法（FCFS）时，填写下表，并计算平均周转时间（四舍五入，保留小数点后两位）。（5 分）
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3341/images/4548.png"> 
<p>平均周转时间T=（100+150+160+190）/4=150

- 采用短进程优先调度算法（SPF）时，填写下表，并计算平均周转时间（四舍五入，保留小数点后两位）。（5 分）
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3341/images/4994.png"> 
<p>平均周转时间T=（100+215+100+130）/4=136.25

## 第 4 章 内存管理

### 【考点：1）基本分页地址计算；2）二级页表地址计算，结合基本分页；3）四种页面置换算法】

#### 基本分页地址计算

1. 某系统采用基本分页存储管理方式，逻辑地址空间为 32 页，每页 2KB，物理地址空间为 1MB。请回答以下问题：

- 逻辑地址有多少位？其中页号占多少位？（4 分）

  ```
  逻辑地址有多少位？
    逻辑地址空间大小 = 32 * 2KB = 64KB = 2的16次方。这个空间大小是16位。
  其中页号占多少位？
    若用m位表示逻辑地址，页大小为2的n次方，用高m-n位表示页号P。
    页大小 = 2KB  ->  2的11次方， m - 11 = 5位。
  ```

- 系统的页框号有多少位？（2 分）

  ```
    物理地址空间的页框大小 = 逻辑地址的页大小;
    物理空间为1MB，页大小为2KB，1MB/2KB=2^9，所以页框号有9位。
  ```

- 如果 CPU 访问内存的速度为 0.2μs，那么有效访存时间为多少？（2 分）

  ```
    CPU访问内存读写数据必须访问两次内存，第一次访问内存从内存表中获取访问单元所在的页框号；
    第二次访问是根据计算出来的物理地址实现对内存单元的访问。
    有效访存时间：2*0.2=0.4μs
  ```

- 如果采用快表，假设在快表中找到页表项的概率为 90%，且查快表的时间为 0，那么有效访存时间为多少？（2 分）

  ```
    采用快表，有效访存时间 = 一次访问快表的时间 + 一次访问内存表的时间；当没有找到快表时候 = 一次访问快表的时间 + 两次访问内存的时间；
    采用快表，有效访问时间：0.9*0.2+（1-0.9）*2*0.2=0.22μs
  ```

#### 二级页表地址计算

```md
基本分页逻辑地址结构 = 页号 + 页内偏移
基本分页求进程的物理地址 = 进程页所在的页框号 x 页大小 + 页内偏移

二级页表逻辑地址结构 = 页目录号 + 页号 + 页内偏移
二级页表求进程的物理地址 = 进程页所在的页框号 x 页大小 + 页内偏移
```

1. 某 32 位机器，采用二级页表的分页存储系统，页大小为 4KB，页框号为 10 位，所采用的二级页表结构如图所示（图中数值均为十进制）。
<p><img src="https://sdjrzk-1251357229.cos.ap-guangzhou.myqcloud.com/exam/paper/3511/images/004.png"></p>

（5 分）逻辑地址 0x00801004 和 0x00401007（0x 表示十六进制）所对应的物理地址是多少？（答案用十进制表示）

<p>0x00801004的物理地址：378*4096+4=1548292     0x00401007的物理地址：115*4096+7-471047</p>

（5 分）如果在 64 位机器上用二级页表的分页存储，系统页大小为 4KB，页框号为 10 位，则页目录号的长度为多少？这会导致什么问题？可以采用什么策略来解决此问题？

<p>页目录号的长度将变为64-12-10-42，这导致页目录表占用大量连续内存空间。可以采用多级页表结构,将外层页表再分若干项，然后为外层页表建立连续存放的索引表。</p>

## 第 5 章 文件管理

### 【考点：i-节点对文件进行磁盘空间的分配】

1. Linux 的 Ext3 文件系统中一个 i 节点包括 31 个地址项，每个地址项存 32 位地址（即 4 字节），其中 20 个地址项存直接地址，7 个地址项存一次间接地址，2 个地址项存二次间接地址，2 个地址项存三次间接地址。当簇大小为 4KB 时，请计算：

- 每个簇能存放多少个簇号？
<p>每个簇能存放的簇号数量：4KB/4B=1K=1024个</p>

- 直接地址能访问的磁盘空间大小是多少？
<p>20个直接地址能访问的磁盘空间大小：20*4KB=80KB</p>

- 一次间接地址能访问的磁盘空间大小是多少？
<p>7个一次间接地址能访问的磁盘空间大小：7*1024*4KB=28MB</p>

- 二次间接地址能访问的磁盘空间大小是多少？
<p>2个二次间接地址能访问的磁盘空间大小：2*1024*1024*4KB=8GB</p>

- 三次间接地址能访问的磁盘空间大小是多少？
<p>2个三次间接地址能访问的磁盘空间大小：2*1024*1024*1024*4KB=8TB</p>

## 第 6 章 I/O 设备管理

### 【考点：1）四种磁盘调度算法；2）读取磁盘文件时间】

#### 读取磁盘文件时间

1. 某磁盘有 50 个道，磁头从一个磁道移至相邻磁道需要 7ms，文件在盘上非连续存放，逻辑上相邻的磁盘块之间的平均距离为 12 磁道，每个磁盘块的旋转延迟时间及传输时间分别为 105ms 和 30ms。

（3 分）磁盘的访问时间由哪几部分组成？

<p>访问时间=寻道时间+旋转延迟时间+传输时间。</p>

（3 分）读取一个由 100 个磁盘块组成的文件需要多少时间？

<p>逻辑上相邻磁盘块的平均距离为12磁道，读取一块数据需要时间为：12*7+105+30=219ms；
<p>读取文件需要的时间为：219*100=21900ms

（4 分）若系统对磁盘进行了整理，让同一文件的磁盘块尽可能靠拢，从而使逻辑上相邻的磁盘块之间的平均距离降为 3 磁道，这时读取一个由 100 个微盘块组成的文件需要多少时间？

<p>磁盘整理后，逻辑上相邻磁盘块的平均距离为3磁道，读一块数据需要时间为：3*7+105+30=156ms；
<p>读取文件需要的时间为：156*100=15600ms

#### 先来先服务算法（FCFS）和最短寻道时间优先算法（SSTF）

1. 假设磁盘有 100 个磁道，磁盘请求按照到达的次序分别处于 20、44、4、80、12 和 76 号磁道上，当前磁头在 40 号磁道上。请分别给出按先来先服务算法（FCFS）和最短寻道时间优先算法（SSTF）进行磁盘调度时的服务次序、总寻道长度和平均寻道长度。（计算结果保留 2 位小数）

```
（1）FCFS：
服务次序：40→20→44→4→80→12→76
总寻道长度：(40-20)＋(44-20)＋(44-4)＋(80-4)＋(80-12)＋(76-12)＝292
平均寻道长度：292/6＝48.67
（2）SSTF：
服务次序：40→44→20→12→4→76→80
总寻道长度：(44-40)＋(44-4)＋(80-4)＝120
平均寻道长度：120/6＝20
```

2. 假设磁盘有 1000 个磁道，磁盘请求按照到达的次序分别处于 128、879、697、480、110 和 381 号磁道上，当前磁头在 350 号磁道上，并向磁道号减小的方向移动。分别给出按 FCFS（先来先服务）和 SCAN（扫描）算法进行磁盘调度时满足请求的次序、总寻道长度和平均寻道长度。

```
FCFS（先来先服务）算法（5分）
服务次序：350-&gt;128-&gt;879-&gt;697-&gt;480-&gt;110-&gt;381
总寻道长度：(350-128)+(879-128)+(879-110)+(381-110)=2013
平均寻道长度：2013/6=335.5

SCAN（扫描）算法（5分）
服务次序：350->128->110->381->480->697->879
总寻道长度：(350-110)+(879-110)=1009
平均寻道长度：1009/6=168.2
```
